# Pre-commit hooks for Python project
# ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã¯Pythonãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚³ãƒ¼ãƒ‰å“è³ªã‚’è‡ªå‹•çš„ã«ãƒã‚§ãƒƒã‚¯ã—ã¾ã™
#
# ğŸš€ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—: mise run install
# ğŸ” æ‰‹å‹•å®Ÿè¡Œ: pre-commit run --all-files
#
# ğŸ’¡ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¾å­˜ã—ãªã„è¨­è¨ˆ:
#   - ã©ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰commitã—ã¦ã‚‚å‹•ä½œã—ã¾ã™

repos:
  # æ±ç”¨ãƒ•ãƒƒã‚¯ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ï¼‰
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.6.0
    hooks:
      # æœ«å°¾ã®ç©ºç™½ã‚’å‰Šé™¤
      - id: trailing-whitespace

      # ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ã«æ”¹è¡Œã‚’è¿½åŠ 
      - id: end-of-file-fixer

      # YAMLãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
      - id: check-yaml

      # JSONãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
      - id: check-json

      # TOMLãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æ–‡ãƒã‚§ãƒƒã‚¯
      - id: check-toml

      # å¤§ããªãƒ•ã‚¡ã‚¤ãƒ«ã®è¿½åŠ ã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆ1MBä»¥ä¸Šï¼‰
      - id: check-added-large-files
        args: [--maxkb=1000]

      # ãƒãƒ¼ã‚¸ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãƒãƒ¼ã‚«ãƒ¼ã®ãƒã‚§ãƒƒã‚¯
      - id: check-merge-conflict

      # Python ASTæ§‹æ–‡ãƒã‚§ãƒƒã‚¯
      - id: check-ast

      # å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚·ã‚§ãƒãƒ³ã‚’ãƒã‚§ãƒƒã‚¯
      - id: check-executables-have-shebangs

      # æ··åœ¨ã—ãŸæ”¹è¡Œã‚³ãƒ¼ãƒ‰ã‚’ãƒã‚§ãƒƒã‚¯
      - id: mixed-line-ending
        args: [--fix=lf]

  # Ruff - é«˜é€ŸãªPythonãƒªãƒ³ã‚¿ãƒ¼ãƒ»ãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
  - repo: https://github.com/astral-sh/ruff-pre-commit
    rev: v0.7.0
    hooks:
      # Ruffãƒªãƒ³ã‚¿ãƒ¼ï¼ˆè‡ªå‹•ä¿®æ­£ä»˜ãï¼‰
      - id: ruff
        args: [--fix]

      # Ruffãƒ•ã‚©ãƒ¼ãƒãƒƒã‚¿ãƒ¼
      - id: ruff-format

  # mypy - Pythonå‹ãƒã‚§ãƒƒã‚¯
  - repo: https://github.com/pre-commit/mirrors-mypy
    rev: v1.13.0
    hooks:
      - id: mypy
        files: ^src/
        additional_dependencies:
          - types-requests

  # ================================================================
  # ğŸ“¦ Dockerå“è³ªãƒã‚§ãƒƒã‚¯
  # ================================================================
  # Dockerfileã‚„docker-compose.ymlã®å“è³ªã‚’ãƒã‚§ãƒƒã‚¯ï¼ˆå…¨ãƒ•ã‚©ãƒ«ãƒ€å¯¾è±¡ï¼‰

  - repo: https://github.com/hadolint/hadolint
    rev: v2.12.0
    hooks:
      # Hadolint - Dockerfileã®lintï¼ˆå…¨ãƒ•ã‚©ãƒ«ãƒ€å¯¾è±¡ï¼‰
      - id: hadolint-docker
        name: hadolint
        args: ['--failure-threshold', 'warning']
        files: .*Dockerfile.*

  - repo: local
    hooks:
      # Docker Composeæ§‹æ–‡ãƒã‚§ãƒƒã‚¯ï¼ˆå…¨ãƒ•ã‚©ãƒ«ãƒ€å¯¾è±¡ï¼‰
      - id: docker-compose-check
        name: docker-compose validate
        entry: bash -c 'for file in "$@"; do docker compose -f "$file" config --quiet || exit 1; done'
        language: system
        files: .*docker-compose\.(yml|yaml)$
        pass_filenames: true

# ã‚°ãƒ­ãƒ¼ãƒãƒ«é™¤å¤–è¨­å®š
exclude: |
  (?x)^(
    __pycache__/.*|
    \.venv/.*|
    \.pytest_cache/.*|
    \.ruff_cache/.*|
    \.mypy_cache/.*|
    build/.*|
    dist/.*|
    \.egg-info/.*|
    htmlcov/.*|
    \.coverage|
    .*\.log|
    \.git/.*
  )$

# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨­å®š
default_install_hook_types: [pre-commit]
default_stages: [pre-commit]
fail_fast: false
minimum_pre_commit_version: 3.0.0
