# mise configuration for Next.js project
# mise ã¯é–‹ç™ºç’°å¢ƒã®ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã¨ã‚¿ã‚¹ã‚¯å®Ÿè¡Œã‚’çµ±ä¸€çš„ã«ç®¡ç†ã—ã¾ã™
#
# ä½¿ã„æ–¹:
#   mise run help     - åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ã‚’è¡¨ç¤º
#   mise run install  - åˆå›ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆä¾å­˜é–¢ä¿‚ã¨pre-commit hooksï¼‰
#   mise run dev      - é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•

[env]

[tasks.help]
description = "åˆ©ç”¨å¯èƒ½ãªã‚³ãƒãƒ³ãƒ‰ä¸€è¦§ã‚’è¡¨ç¤º"
run = "mise tasks"

# ==================== Setup Commands ====================
[tasks.install]
description = "ä¾å­˜é–¢ä¿‚ã¨Git hooksã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
alias = "setup"
run = """
#!/bin/bash
echo "ğŸš€ Setting up development environment..."

# Install Node dependencies
echo "ğŸ“¦ Installing dependencies..."
pnpm install

# Setup environment files
echo "ğŸ”§ Setting up environment files..."
cp -n .env.example .env.local 2>/dev/null || true

# Install pre-commit hooks
echo "ğŸª Installing pre-commit hooks..."
pre-commit install

echo "âœ… Setup complete! Run 'mise run dev' to start"
"""

[tasks.clean-setup]
description = "ã‚¯ãƒªãƒ¼ãƒ³ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ï¼ˆnode_moduleså‰Šé™¤ã—ã¦å†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼‰"
run = """
#!/bin/bash
echo "ğŸ§¹ Cleaning and reinstalling..."
rm -rf node_modules pnpm-lock.yaml package-lock.json yarn.lock
pnpm install
echo "âœ… Clean setup complete!"
"""

# ==================== Development Commands ====================
[tasks.dev]
description = "é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•"
run = "pnpm dev"

[tasks.build]
description = "æœ¬ç•ªç”¨ãƒ“ãƒ«ãƒ‰"
run = "pnpm build"

[tasks.start]
description = "æœ¬ç•ªã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•"
run = "pnpm start"

[tasks.preview]
description = "æœ¬ç•ªãƒ“ãƒ«ãƒ‰ã‚’ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼"
run = """
#!/bin/bash
pnpm build && pnpm start
"""

# ==================== Testing Commands ====================
[tasks.test]
description = "ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ"
run = "pnpm test"

[tasks.test-watch]
description = "ãƒ†ã‚¹ãƒˆã‚’watchãƒ¢ãƒ¼ãƒ‰ã§å®Ÿè¡Œ"
run = "pnpm test --watch"

[tasks.test-ui]
description = "ãƒ†ã‚¹ãƒˆUIã‚’èµ·å‹•"
run = "pnpm test:ui"

[tasks.test-coverage]
description = "ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ"
run = "pnpm coverage"

[tasks.test-all]
description = "ã™ã¹ã¦ã®ãƒ†ã‚¹ãƒˆã‚’ã‚«ãƒãƒ¬ãƒƒã‚¸ä»˜ãã§å®Ÿè¡Œ"
run = """
#!/bin/bash
echo "ğŸ§ª Running all tests..."
pnpm test --run
pnpm coverage
echo "âœ… All tests complete!"
"""

# ==================== Code Quality Commands ====================
[tasks.lint]
description = "ESLintã‚’å®Ÿè¡Œ"
run = "pnpm lint"

[tasks.lint-fix]
description = "ESLintã§è‡ªå‹•ä¿®æ­£"
run = "pnpm lint --fix"

[tasks.format]
description = "Prettierã§ã‚³ãƒ¼ãƒ‰ã‚’ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ"
run = "pnpm prettier --write ."

[tasks.type-check]
description = "TypeScriptå‹ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ"
run = "pnpm tsc --noEmit"

[tasks.check-all]
description = "ã™ã¹ã¦ã®ãƒã‚§ãƒƒã‚¯ã‚’å®Ÿè¡Œ via pre-commit"
run = "pre-commit run --all-files"

# ==================== pre-commit Commands ====================

[tasks.pre-commit]
description = "pre-commitãƒã‚§ãƒƒã‚¯ã‚’æ‰‹å‹•å®Ÿè¡Œ"
run = "pre-commit run --all-files"

[tasks.pre-commit-update]
description = "pre-commitãƒ•ãƒƒã‚¯ã‚’æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«æ›´æ–°"
run = "pre-commit autoupdate"

[tasks.pre-commit-uninstall]
description = "pre-commitãƒ•ãƒƒã‚¯ã‚’ã‚¢ãƒ³ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«"
run = """
#!/bin/bash
echo "ğŸ—‘ï¸ Uninstalling pre-commit hooks..."
pre-commit uninstall
pre-commit uninstall --hook-type commit-msg
echo "âœ… Pre-commit hooks uninstalled!"
"""

[tasks.pre-commit-clean]
description = "pre-commitã‚’å®Œå…¨å‰Šé™¤ï¼ˆãƒ•ãƒƒã‚¯ã¨ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼‰"
run = """
#!/bin/bash
echo "ğŸ§¹ Completely removing pre-commit..."
# Uninstall hooks
pre-commit uninstall 2>/dev/null || true
pre-commit uninstall --hook-type commit-msg 2>/dev/null || true
pre-commit uninstall --hook-type pre-push 2>/dev/null || true
# Remove cache
rm -rf ~/.cache/pre-commit 2>/dev/null || true
echo "âœ… Pre-commit cache removed!"
"""

# ==================== Bundle Analysis ====================
[tasks.analyze]
description = "ãƒãƒ³ãƒ‰ãƒ«ã‚µã‚¤ã‚ºã‚’åˆ†æ"
run = "ANALYZE=true pnpm build"
